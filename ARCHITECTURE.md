# EasyDaddy Extension Architecture

## üéØ –¶–µ–ª–µ–≤—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –∏ –≤–µ—Ä—Å–∏–∏

- Google Chrome (–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏, LTS)
- Arc Browser
- Microsoft Edge (Chromium)
- Mozilla Firefox (WebExtensions)
- Opera (Chromium)
- **Apple Safari (Safari 11+, WebExtensions API)**

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∫—Ä–æ—Å—Å-–±—Ä–∞—É–∑–µ—Ä–Ω–æ—Å—Ç–∏

- **–ï–¥–∏–Ω–∞—è –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WebExtensions API –∏ Manifest V3 –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è
- **browser-compat.ts**: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è API (chrome, browser, window)
- **–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è browser-specific –∫–æ–¥–∞**: –í—Å–µ —Ä–∞–∑–ª–∏—á–∏—è –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ
- **Feature detection**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π API, –∞ –Ω–µ user agent sniffing
- **Graceful degradation**: –í Safari –∏ –¥—Ä—É–≥–∏—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ ‚Äî fallback UI –∏ —Å–æ–æ–±—â–µ–Ω–∏—è

## üçè –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Safari/WebKit

- **WebExtensions API**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ Safari
- **Manifest V3**: –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º Safari (–Ω–∞–ø—Ä–∏–º–µ—Ä, service worker, permissions)
- **CSP –∏ sandbox**: –£—á–µ—Ç –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π CSP –≤ Safari
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö Chrome-only API, –≤–æ–∑–º–æ–∂–Ω—ã –æ—Ç–ª–∏—á–∏—è –≤ —Ä–∞–±–æ—Ç–µ content scripts
- **–°–±–æ—Ä–∫–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏ WebExtension –≤ .safariextz (Xcode, Safari Extension Converter)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ Safari Technology Preview

## üçè Safari: Known Issues & Build Instructions

### –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ Safari

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Xcode (File ‚Üí New ‚Üí Project ‚Üí macOS ‚Üí App ‚Üí Safari Web Extension)
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ø–∞–ø–∫—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (WebExtension)
- Xcode –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–µ–∫—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Safari
- –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Xcode (Run)
- –í–∫–ª—é—á–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Safari

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ workaround

- –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ Chrome-only API (chrome.scripting, chrome.action)
- CSP –≤ Safari —Å—Ç—Ä–æ–∂–µ, —á–µ–º –≤ Chrome/Firefox (–∑–∞–ø—Ä–µ—â–µ–Ω—ã inline-—Å–∫—Ä–∏–ø—Ç—ã, eval)
- –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å dynamic import –∏ pdfjs-dist (PDF –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- Messaging –º–µ–∂–¥—É background –∏ content script –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏–Ω–∞—á–µ
- –î–ª—è storage —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å browser.storage.local
- –î–ª—è fallback UI –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ feature detection (window.safari, browser, chrome)
- –í—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω—ã –≤ manifest.json

> –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ Safari Technology Preview –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ Safari-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –±–∞–≥–∏ –≤ Known Issues.

## üß™ –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤–æ –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
- **–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í Safari, Arc, Firefox, Edge, Chrome
- **CI/CD**: –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SauceLabs/BrowserStack –¥–ª—è –∫—Ä–æ—Å—Å-–±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –í—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ known issues —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ README –∏ ARCHITECTURE.md

## üö© Known Issues & Roadmap

- Safari: –í–æ–∑–º–æ–∂–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å PDF, background scripts, storage
- Arc: –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è popup (—Å–º. README)
- Firefox: –û—Ç–ª–∏—á–∏—è –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö API

> **–ú–∏—Å—Å–∏—è:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–∞–∫ truly universal WebExtension –¥–ª—è –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤, –≤–∫–ª—é—á–∞—è Safari. 